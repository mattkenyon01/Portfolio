@page "/Games/topdownshooter"
@using Portfolio.Pages
@using Portfolio.Utilities
@inject IJSRuntime JS
@layout GamesAndAppsLayout


<img src="Images/Uni Game 1.png" alt="Banner Image" class="main-banner" />
<h1 id="about">Game for Rehabilitation of Stroke</h1>
<p class="description">
    I’m a passionate software developer dedicated to creating intuitive, impactful programs that assist people.

    <br /><br />

    I attended Newcastle University, where I was awarded the Degree of Masters of Computing with First Class Honours in
    Computer Science (Game Engineering).
</p>

<hr class="section-divider" />

<div class="stats-section" id="games">
    <h2>University Grades</h2>
    <div class="stats-content">
        <!-- Charts group -->
        <div class="chart-group">
            <div class="chart-item">
                <div class="chart-container">
                    <canvas id="grade"></canvas>
                    <div class="chart-value" id="gradeValue">94%</div>
                </div>
                <p class="chart-title">Overall Grade</p>
            </div>
        </div>

        <!-- Note to the right -->
        <div class="stats-note">
            This project was completed as a dissertation at Newcastle University and was received very positively. It achieved a high First Class, with strong marks across each section. It was praised by health professionals for its thorough research into both targeted muscle engagement and cognitive benefits — including the use of colour theory to enhance memory — plus accessibility-focused design and comprehensive performance and progress tracking.
        </div>
    </div>
</div>

<hr class="section-divider" />

<style>
    .features-section {
        max-width: 1000px;
        width: 100%;
        margin: 0 auto;
        padding: 0 20px;
    }

        .features-section h2 {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin: 10px 0 22px 0;
        }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 18px;
        align-items: stretch;
    }

    /* Card */
    .feature-card {
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 16px;
        padding: 20px 18px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
    }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 22px rgba(0,0,0,0.25);
            background: rgba(255,255,255,0.08);
        }

    .feature-icons {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-bottom: 10px;
    }

        .feature-icons img {
            width: 56px;
            height: 56px;
            object-fit: contain;
            opacity: 0.95;
        }

    .feature-title {
        font-weight: 800;
        font-size: 1.1rem;
        margin: 4px 0 6px 0;
        letter-spacing: .2px;
    }

    .feature-desc {
        font-size: .98rem;
        line-height: 1.55;
        opacity: 0.95;
        margin: 0;
        max-width: 32ch;
    }

    /* Responsive */
    @@media (max-width: 900px) {
        .features-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @@media (max-width: 620px) {
        .features-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<section class="image-text-section">
    <img src="Images/Uni World 2.png" alt="Project Screenshot" />
    <div class="image-text-content">
        <h2>Features</h2>
        <p>
            There are 8 minigames for the patient to try. They are separated into 4 groups, with 2 unique movements
            targeted at each muscle in the hand. Three games are randomly chosen each time the user plays, so each experience
            is different and kept entertaining and varied.
        </p>
    </div>
</section>

<section class="image-text-section">
    <div class="image-text-content">
        <h2>Scene</h2>
        <p>
            The instructions for each game are shown beforehand, with diagrams to make it easy to play. These are presented
            until the user clicks or says “Play,” which will then start the game. The user also has the option to pause the game
            or replay using voice controls.
        </p>
    </div>
    <img src="Images/Uni World 3.png" alt="Project Screenshot" />
</section>


<hr class="section-divider" />
<section class="features-section">
    <h2>Software</h2>
    <div class="features-grid">
        <div class="feature-card">
            <div class="feature-icons">
                <img class="feature-icon" src="@IconRef.GetIcon("unity")" alt="Unity Icon">
                <img class="feature-icon" src="@IconRef.GetIcon("c#")" alt="C# Icon">
            </div>
            <div class="feature-title">Unity + C#</div>
            <p class="feature-desc">
                Unity was the best application to use with OpenCV, as the pinpoints in the hand could easily be treated as individual game objects. This made it easy to verify whether the hand movements were completed correctly, since only the proximity of the tracked points needed to be checked.
            </p>
        </div>
    </div>
</section>

<script>
    window.renderChart = function (chartId, valuePercent) {
        const el = document.getElementById(chartId);
        if (!el || !window.Chart) return;

        const ctx = el.getContext('2d');

        // Clamp 0..100
        const percent = Math.max(0, Math.min(100, Number(valuePercent) || 0));
        const remainder = 100 - percent;

        // Destroy previous instance if any
        if (el._chartInstance) el._chartInstance.destroy();

        el._chartInstance = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Achieved', 'Remaining'],
                datasets: [{
                    data: [percent, remainder],
                    /* keep transparent page background; donut has its own segment fills */
                    backgroundColor: ['#4caf50', 'rgba(255,255,255,0.12)'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '65%',
                animation: { duration: 700 },
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: true }
                }
            }
        });

        // Optional center text update if you keep a value element
        const centerEl = document.getElementById(chartId + 'Value') || document.getElementById('gradeValue');
        if (centerEl) centerEl.textContent = percent + '%';
    };
</script>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("renderChart", "grade", 94);
        }
    }
}
